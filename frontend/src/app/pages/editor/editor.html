<div class="editor-container" *ngIf="sow && project">
  <div class="editor-header">
    <h2>Editing SOW for: {{ project.name }}</h2>
    <div class="editor-actions">
      <a [routerLink]="['/projects', project.id]" class="action-link">Back to Project Status</a>
      <span class="status-message">{{ statusMessage }}</span>

      <!-- RE-ADDED LOGIC -->
      <a *ngIf="sow.googleDocUrl" [href]="sow.googleDocUrl" target="_blank" class="gdoc-link">View Google Doc</a>
      <button *ngIf="!sow.googleDocUrl" (click)="createGoogleDoc()" [disabled]="isCreatingGDoc" class="btn-primary">
        {{ isCreatingGDoc ? 'Creating...' : 'Create Google Doc' }}
      </button>

      <button (click)="saveSow()" [disabled]="!isDirty || isSaving">
        {{ isSaving ? 'Saving...' : 'Save Changes' }}
      </button>
    </div>
  </div>
  <div class="tab-nav">
    <button class="tab-button" [class.active]="activeTab === 'write'" (click)="activeTab = 'write'">Write</button>
    <button class="tab-button" [class.active]="activeTab === 'preview'" (click)="activeTab = 'preview'">Preview</button>
  </div>
  <div class="editor-content">
    <textarea *ngIf="activeTab === 'write'" class="markdown-editor" [(ngModel)]="editableSowText"></textarea>
    <div *ngIf="activeTab === 'preview'" class="markdown-preview">
      <markdown [data]="editableSowText"></markdown>
    </div>
  </div>
</div>

<div *ngIf="!sow || !project" class="loading-container">
  <p>Loading SOW content...</p>
</div>