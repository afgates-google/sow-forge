<div class="page-container">
  <!-- The <h2> and <p> are now OUTSIDE the main card, at the page level -->
  <h2>Prompt Management</h2>
  <p>Select a prompt to view and edit its content. The 'Preview' tab shows how Markdown will render.</p>

  <div class="content-card">
    <div *ngIf="isLoadingList">
      <p>Loading available prompts...</p>
    </div>

    <div *ngIf="!isLoadingList">
      <!-- Prompt Selection Dropdown -->
      <div class="form-group">
        <label for="prompt-select">Select a Prompt to Edit</label>
        <select id="prompt-select" [(ngModel)]="selectedPromptId" (change)="onPromptSelected()">
          <option *ngFor="let prompt of prompts" [value]="prompt.id">
            {{ prompt.name || prompt.id }}
          </option>
        </select>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-nav">
        <button class="tab-button" [class.active]="activeTab === 'write'" (click)="activeTab = 'write'">
          Write
        </button>
        <button class="tab-button" [class.active]="activeTab === 'preview'" (click)="activeTab = 'preview'">
          Preview
        </button>
      </div>

      <!-- Tabbed Editor Content -->
      <div class="editor-content">
        <div *ngIf="isLoadingPrompt" class="loading-prompt">Loading content...</div>
        
        <textarea 
          *ngIf="!isLoadingPrompt && activeTab === 'write'" 
          class="prompt-editor" 
          [(ngModel)]="editablePromptText">
        </textarea>
        
        <div *ngIf="!isLoadingPrompt && activeTab === 'preview'" class="markdown-preview">
          <markdown [data]="editablePromptText"></markdown>
        </div>
      </div>

      <!-- Action Bar -->
      <div class="actions">
        <button (click)="savePrompt()" [disabled]="isPristine() || isSaving">
          {{ isSaving ? 'Saving...' : 'Save Changes' }}
        </button>
        <span class="status-message">{{ statusMessage }}</span>
      </div>
    </div>
  </div>
</div>